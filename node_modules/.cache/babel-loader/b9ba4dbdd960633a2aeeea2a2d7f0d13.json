{"ast":null,"code":"import jwt_decode from \"jwt-decode\";\nimport { LOGIN, LOGOUT, GET_USERS, CLEAR_USERS, GET_CURRENT_USER } from \"../types\";\nimport { findUsers, login, registration } from '../../api/userApi';\nexport const loginAction = (formdata, isLogin) => {\n  return async dispatch => {\n    try {\n      const data = isLogin ? await login(formdata) : await registration(formdata);\n      dispatch({\n        type: LOGIN,\n        payload: data.data.token\n      });\n      localStorage.token = data.data.token;\n    } catch (error) {\n      throw new Error(error);\n    }\n  };\n};\nexport const logout = () => {\n  localStorage.clear();\n  return {\n    type: LOGOUT\n  };\n};\nexport const clearUsers = () => ({\n  type: CLEAR_USERS\n});\nexport const getUsers = nickname => {\n  return async dispatch => {\n    try {\n      const users = await findUsers(nickname);\n      console.log(users);\n      const data = users.data.map(u => {\n        if (u.photo) {\n          u.photo = Buffer(u.photo.data, 'binary').toString('base64');\n        }\n      });\n      dispatch({\n        type: GET_USERS,\n        payload: data\n      });\n    } catch (error) {\n      console.log(error);\n    }\n  };\n};\nexport const getCurrentUser = () => {\n  const token = localStorage.token;\n  const user = jwt_decode(token);\n  return {\n    type: GET_CURRENT_USER,\n    payload: user\n  };\n};","map":{"version":3,"sources":["F:/web/chat/client/src/store/actions/userAction.js"],"names":["jwt_decode","LOGIN","LOGOUT","GET_USERS","CLEAR_USERS","GET_CURRENT_USER","findUsers","login","registration","loginAction","formdata","isLogin","dispatch","data","type","payload","token","localStorage","error","Error","logout","clear","clearUsers","getUsers","nickname","users","console","log","map","u","photo","Buffer","toString","getCurrentUser","user"],"mappings":"AAAA,OAAOA,UAAP,MAAuB,YAAvB;AACA,SAASC,KAAT,EAAgBC,MAAhB,EAAwBC,SAAxB,EAAmCC,WAAnC,EAAgDC,gBAAhD,QAAwE,UAAxE;AACA,SAASC,SAAT,EAAoBC,KAApB,EAA2BC,YAA3B,QAA+C,mBAA/C;AAEA,OAAO,MAAMC,WAAW,GAAG,CAACC,QAAD,EAAWC,OAAX,KAAuB;AAChD,SAAO,MAAMC,QAAN,IAAkB;AACvB,QAAI;AACF,YAAMC,IAAI,GAAGF,OAAO,GAChB,MAAMJ,KAAK,CAACG,QAAD,CADK,GAEhB,MAAMF,YAAY,CAACE,QAAD,CAFtB;AAGAE,MAAAA,QAAQ,CAAC;AACPE,QAAAA,IAAI,EAAEb,KADC;AACMc,QAAAA,OAAO,EAAEF,IAAI,CAACA,IAAL,CAAUG;AADzB,OAAD,CAAR;AAGAC,MAAAA,YAAY,CAACD,KAAb,GAAqBH,IAAI,CAACA,IAAL,CAAUG,KAA/B;AACD,KARD,CAQE,OAAOE,KAAP,EAAc;AACd,YAAM,IAAIC,KAAJ,CAAUD,KAAV,CAAN;AACD;AAEF,GAbD;AAcD,CAfM;AAiBP,OAAO,MAAME,MAAM,GAAG,MAAM;AAC1BH,EAAAA,YAAY,CAACI,KAAb;AACA,SAAO;AACLP,IAAAA,IAAI,EAAEZ;AADD,GAAP;AAGD,CALM;AAOP,OAAO,MAAMoB,UAAU,GAAG,OAAO;AAAER,EAAAA,IAAI,EAAEV;AAAR,CAAP,CAAnB;AAEP,OAAO,MAAMmB,QAAQ,GAAGC,QAAQ,IAAI;AAClC,SAAO,MAAMZ,QAAN,IAAkB;AACvB,QAAI;AACF,YAAMa,KAAK,GAAG,MAAMnB,SAAS,CAACkB,QAAD,CAA7B;AACAE,MAAAA,OAAO,CAACC,GAAR,CAAYF,KAAZ;AACA,YAAMZ,IAAI,GAAGY,KAAK,CAACZ,IAAN,CAAWe,GAAX,CAAeC,CAAC,IAAI;AAC/B,YAAIA,CAAC,CAACC,KAAN,EAAa;AACXD,UAAAA,CAAC,CAACC,KAAF,GAAUC,MAAM,CAACF,CAAC,CAACC,KAAF,CAAQjB,IAAT,EAAe,QAAf,CAAN,CAA+BmB,QAA/B,CAAwC,QAAxC,CAAV;AACD;AACF,OAJY,CAAb;AAMApB,MAAAA,QAAQ,CAAC;AACPE,QAAAA,IAAI,EAAEX,SADC;AACUY,QAAAA,OAAO,EAAEF;AADnB,OAAD,CAAR;AAGD,KAZD,CAYE,OAAOK,KAAP,EAAc;AACdQ,MAAAA,OAAO,CAACC,GAAR,CAAYT,KAAZ;AACD;AACF,GAhBD;AAiBD,CAlBM;AAoBP,OAAO,MAAMe,cAAc,GAAG,MAAM;AAClC,QAAMjB,KAAK,GAAGC,YAAY,CAACD,KAA3B;AACA,QAAMkB,IAAI,GAAGlC,UAAU,CAACgB,KAAD,CAAvB;AACA,SAAO;AAACF,IAAAA,IAAI,EAAET,gBAAP;AAAyBU,IAAAA,OAAO,EAAEmB;AAAlC,GAAP;AACD,CAJM","sourcesContent":["import jwt_decode from \"jwt-decode\";\r\nimport { LOGIN, LOGOUT, GET_USERS, CLEAR_USERS, GET_CURRENT_USER } from \"../types\"\r\nimport { findUsers, login, registration } from '../../api/userApi';\r\n\r\nexport const loginAction = (formdata, isLogin) => {\r\n  return async dispatch => {\r\n    try {\r\n      const data = isLogin\r\n        ? await login(formdata)\r\n        : await registration(formdata)\r\n      dispatch({\r\n        type: LOGIN, payload: data.data.token\r\n      })\r\n      localStorage.token = data.data.token;\r\n    } catch (error) {\r\n      throw new Error(error)\r\n    }\r\n\r\n  }\r\n}\r\n\r\nexport const logout = () => {\r\n  localStorage.clear()\r\n  return {\r\n    type: LOGOUT,\r\n  }\r\n}\r\n\r\nexport const clearUsers = () => ({ type: CLEAR_USERS })\r\n\r\nexport const getUsers = nickname => {\r\n  return async dispatch => {\r\n    try {\r\n      const users = await findUsers(nickname)\r\n      console.log(users);\r\n      const data = users.data.map(u => {\r\n        if (u.photo) {\r\n          u.photo = Buffer(u.photo.data, 'binary').toString('base64')\r\n        }\r\n      })\r\n\r\n      dispatch({\r\n        type: GET_USERS, payload: data\r\n      })\r\n    } catch (error) {\r\n      console.log(error);\r\n    }\r\n  }\r\n}\r\n\r\nexport const getCurrentUser = () => {\r\n  const token = localStorage.token\r\n  const user = jwt_decode(token);\r\n  return {type: GET_CURRENT_USER, payload: user}\r\n}\r\n\r\n"]},"metadata":{},"sourceType":"module"}